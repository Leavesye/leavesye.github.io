webpackJsonp([33],{Fdun:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("vLgD"),i=n("TIfe");var s=n("0j9R"),a=n("0xDb"),r=n("Y0Uy"),c=n.n(r),l=n("wS1x"),m=n.n(l),d={name:"system-menumamager",data:function(){return{btns:[{text:"添加",icon:"el-icon-circle-plus",cb:this.handleAdd,isShow:!0},{text:"编辑",icon:"el-icon-edit",cb:this.handleEdit,isShow:!1},{text:"取消",icon:"el-icon-close",cb:this.handleCancel,isShow:!0},{text:"删除",icon:"el-icon-delete",cb:this.handleDelete,isShow:!1}],formConfig:[{type:1,label:"菜单编码",key:"code"},{type:1,label:"菜单名称",key:"name"},{type:3,label:"菜单类型",key:"type",options:[]},{type:5,label:"所属菜单",key:"belong",data:[],cb:this.handleSelectTree},{type:1,label:"显示图标",key:"icon"},{type:1,label:"访问路径",key:"href"},{type:1,label:"显示顺序",key:"orderNum"}],form:{code:"",name:"",type:"",belong:"",icon:"",href:"",orderNum:""},layoutConfig:{xs:24,sm:24,md:24},tree:{leftTree:[],chooseItem:null},isLoading:!1,currentId:"",selectPid:""}},components:{CommonForm:s.a,VJstree:m.a},methods:{resetForm:function(){this.form={code:"",name:"",type:"",belong:"",icon:"",href:"",orderNum:""}},toggleAdd:function(){this.btns[0].isShow=!0,this.btns[1].isShow=!1,this.btns[3].isShow=!1,this.resetForm()},handleAdd:function(){var e,t=this;this.currentId="",(e=this.form,Object(o.a)({url:"/admin/menu/menus",method:"post",data:e})).then(function(){t.$message({type:"success",message:"添加成功"}),t.resetForm(),t.loadData()})},handleEdit:function(){var e,t,n=this;(e=this.currentId,t=this.form,Object(o.a)({url:"/admin/menu/menus/"+e+"?token="+Object(i.a)(),method:"put",data:t})).then(function(){n.$message({type:"success",message:"修改成功"}),n.loadData()})},handleCancel:function(){this.btns[0].isShow=!0,this.btns[1].isShow=!1,this.btns[3].isShow=!1,this.resetForm()},handleDelete:function(){var e=this;this.$confirm("删除菜单会删除与该菜单相关联的数据，确定要删除吗？","信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t;(t=e.currentId,Object(o.a)({url:"/admin/menu/menus/"+t+"?token="+Object(i.a)(),method:"delete"})).then(function(){e.resetForm(),e.loadData(),e.$message({type:"success",message:"删除成功!"})})}).catch(function(){})},handleSelectTree:function(e,t){this.form.pId=t.id,this.form.belong=t.name},itemClick:function(e,t){var n,i=this;this.currentId=t.id,this.btns[0].isShow=!1,this.btns[1].isShow=!0,this.btns[3].isShow=!0,(n=t.id,Object(o.a)({url:"/admin/menu/menus/"+n,method:"get"})).then(function(e){var t=e.crmSysMenu;i.form.code=t.code,i.form.href=t.href,i.form.name=t.name,i.form.icon=t.icon;var n=c.a.find(e.menuTree,function(e){return e.id==t.pId});i.form.belong=n?n.name:"",i.form.type=String(t.type),i.form.orderNum=t.orderNum}),this.tree.chooseItem=t},loadData:function(){var e=this;return this.isLoading=!0,Object(o.a)({url:"/admin/menu/init",method:"get"}).then(function(t){e.formConfig[2].options=t.type;var n=Object(a.b)(t.menuTree);e.tree.leftTree=n,e.formConfig[3].data=c.a.cloneDeep(n),e.isLoading=!1}).catch(function(t){console.log(t),e.isLoading=!1})}},mounted:function(){this.loadData()}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{staticClass:"system-menu",attrs:{gutter:20}},[n("el-col",{attrs:{xs:24,sm:8,md:8}},[n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"menu-card",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("菜单列表")]),e._v(" "),n("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.toggleAdd}},[e._v("添加菜单")])],1),e._v(" "),n("v-jstree",{attrs:{data:e.tree.leftTree,"whole-row":"","text-field-name":"name"},on:{"item-click":e.itemClick}})],1)],1),e._v(" "),n("el-col",{attrs:{xs:24,sm:16,md:16}},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[n("common-form",{attrs:{formConfig:e.formConfig,layoutConfig:e.layoutConfig,form:e.form}})],1),e._v(" "),e._l(e.btns,function(t){return t.isShow?n("el-button",{key:t.text,attrs:{type:"primary",icon:t.icon},on:{click:t.cb}},[e._v(e._s(t.text))]):e._e()})],2)],1)},staticRenderFns:[]};var h=n("vSla")(d,u,!1,function(e){n("jcsJ")},"data-v-3ee70ae1",null);t.default=h.exports},jcsJ:function(e,t,n){var o=n("tNSd");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);n("8bSs")("f13ab584",o,!0)},tNSd:function(e,t,n){(e.exports=n("BkJT")(!1)).push([e.i,"\n.system-menu[data-v-3ee70ae1] {\n  padding: 10px;\n}\n.system-menu .menu-card[data-v-3ee70ae1] {\n    height: 500px;\n    overflow: auto;\n}\n",""])}});