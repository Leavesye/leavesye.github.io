webpackJsonp([21],{TEJp:function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"",""])},UvN6:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("rVsN"),r=a.n(n),i=a("Y0Uy"),o=a.n(i),s=a("5VXh"),l=a("0j9R"),u=a("jNdV"),m=a("0xDb"),d={name:"user-edit",components:{CommonForm:l.a},data:function(){return{isLoading:!1,form:{id:"",name:"",username:"",sex:"",deptId:"",deptName:"",password:"",cpwd:"",manageDeptId:"",manageDeptName:"",birthday:"",mobile:"",email:"",address:""},rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"},{min:1,max:20,message:"长度需在 1 到 20 个字符",trigger:"blur"}],deptName:[{required:!0,message:"所属部门不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,max:16,message:"请填写6-16位字符，不能包含空格、中文",trigger:"blur"}],cpwd:[{required:!0,message:"确认密码不能为空",trigger:"blur"},{min:6,max:16,message:"请填写6-16位字符，不能包含空格、中文",trigger:"blur"}]},layoutConfig:{xs:24,sm:12,md:12},formConfig:[]}},methods:{handleSelectDept:function(e,t){this.form.deptId=t.id,this.form.deptName=t.name},handleSelectManageDept:function(e,t){this.form.manageDeptId=t.id,this.form.manageDeptName=t.name},handleSave:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var a=t.$route.params.id;"0"!==a?(t.form.id=a,update(t.form).then(function(e){t.$router.push("/system/user"),s.Message.success("修改成功")})):Object(u.a)(t.form).then(function(e){s.Message.success("保存成功"),t.$router.push("/system/user")})})},handleCancel:function(){this.$router.push("/system/user")},getOptions:function(){var e=this;return Object(u.h)().then(function(t){o.a.each(e.formConfig,function(e){"性别"==e.label&&(e.options=t.gender)})}).catch(function(e){console.log(e)})},getTree:function(){var e=this;return Object(u.c)().then(function(t){var a=Object(m.b)(t);o.a.each(e.formConfig,function(e){["所属部门","管理部门"].includes(e.label)&&(e.data=o.a.cloneDeep(a))})})},loadDetail:function(e){var t=this;Object(u.f)(e).then(function(e){var a=e.userInfo;t.form.name=a.name;var n=o.a.find(t.formConfig[6].options,function(e){return e.value==a.sex});t.form.sex=n?n.text:"";var r=o.a.find(e.deptTree,function(e){return e.id==a.deptId});t.form.deptName=r?r.name:"";var i=o.a.find(e.deptTree,function(e){return e.id==a.manageDeptId});t.form.manageDeptName=i?i.name:"",t.form.birthday=a.birthday,t.form.mobile=a.mobile,t.form.email=a.email,t.form.address=a.address})}},created:function(){this.formConfig="0"==this.$route.params.id?[{type:1,label:"用户名",key:"username"},{type:1,label:"姓名",key:"name"},{type:1,label:"密码",key:"password"},{type:1,label:"确认密码",key:"cpwd"},{type:5,label:"所属部门",key:"deptName",data:[],cb:this.handleSelectDept},{type:5,label:"管理部门",key:"manageDeptName",data:[],cb:this.handleSelectManageDept},{type:3,label:"性别",key:"sex",options:[]},{type:4,label:"出生日期",key:"birthday"},{type:1,label:"手机号码",key:"mobile"},{type:1,label:"邮箱",key:"email"},{type:1,label:"联系地址",key:"address"}]:[{type:1,label:"姓名",key:"name"},{type:1,label:"性别",key:"sex"},{type:5,label:"所属部门",key:"deptName",data:[],cb:this.handleSelectDept},{type:5,label:"管理部门",key:"manageDeptName",data:[],cb:this.handleSelectManageDept},{type:4,label:"出生日期",key:"birthday"},{type:1,label:"手机号码",key:"mobile"},{type:1,label:"邮箱",key:"email"},{type:1,label:"联系地址",key:"address"}]},mounted:function(){var e=this,t=[this.getOptions(),this.getTree()],a=this.$route.params.id;"0"===a?r.a.all(t):r.a.all(t).then(function(){e.loadDetail(a)})}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],ref:"form",staticClass:"edit-container",attrs:{model:e.form,rules:e.rules,"label-width":"80px","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[a("common-form",{attrs:{formConfig:e.formConfig,layoutConfig:e.layoutConfig,form:e.form}}),e._v(" "),a("el-row",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSave("form")}}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},staticRenderFns:[]};var f=a("vSla")(d,c,!1,function(e){a("aKf8")},"data-v-2ef9b59a",null);t.default=f.exports},aKf8:function(e,t,a){var n=a("TEJp");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("8bSs")("c7323024",n,!0)},jNdV:function(e,t,a){"use strict";t.g=function(){return Object(n.a)({url:"/admin/menu/system/permission/buttons/42",method:"get"})},t.d=function(e){return Object(n.a)({url:"/admin/user/users",method:"get",params:e})},t.h=function(e){return Object(n.a)({url:"/admin/user/init",method:"get",params:e})},t.c=function(){return Object(n.a)({url:"/admin/dept/init",method:"get"})},t.f=function(e){return Object(n.a)({url:"/admin/user/users/"+e,method:"get"})},t.b=function(e){return Object(n.a)({url:"/admin/user/users/"+e+"?token="+Object(r.a)(),method:"delete"})},t.a=function(e){return Object(n.a)({url:"/admin/user/users",method:"post",data:e})},t.k=function(e){return Object(n.a)({url:"/admin/user/users/"+e+"/unlock?token="+Object(r.a)(),method:"put"})},t.i=function(e){return Object(n.a)({url:"/admin/user/users/password?token="+Object(r.a)(),method:"put",data:e})},t.e=function(e){return Object(n.a)({url:"/admin/role/roles/tree/"+e,method:"get"})},t.j=function(e){return Object(n.a)({url:"/admin/role/roles/assign",method:"post",data:e})};var n=a("vLgD"),r=a("TIfe")}});