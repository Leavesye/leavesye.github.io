webpackJsonp([1,37],{A9qC:function(e,t,n){var a=n("hfpR");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("8bSs")("7d37bda4",a,!0)},TomH:function(e,t,n){"use strict";(function(e){var a=n("rVsN"),o=n.n(a),c=n("YvLT"),i=n("5VXh"),s=(n.n(i),n("dizt")),l=n("0xDb"),r=n("wS1x"),d=n.n(r),u=n("nV64"),h=n("rnde"),p=n("Y0Uy"),m=n.n(p),f=n("1fno");t.a={name:"customlabel-list",components:{SearchForm:u.e,FuncButtons:u.c,ArvatoTable:u.a,VJstree:d.a,ExportPage:h.default,Pagination:u.d},data:function(){return{pc:{search:{form:{segmentName:"",isStatic:"",isActivated:"",sort:"id",order:"desc",offset:0,limit:10,menuId:36},layoutConfig:{xs:24,sm:12,md:6},formConfig:[{type:1,label:"细分名称",key:"segmentName"},{type:3,label:"细分类型",key:"isStatic",options:[]},{type:3,label:"状态",key:"isActivated",options:[]}],btns:[{text:"搜索",cb:this.handleSearch}]},functions:{checkList:["细分名称","状态","细分类型","细分人数"],handleExpandAll:this.handleExpandAll,rightBtns:[{text:"添加",icon:"el-icon-circle-plus",cb:this.handleAdd},{text:"编辑",icon:"el-icon-edit",cb:this.handleEdit},{text:"删除",icon:"el-icon-delete",cb:this.handleDelete},{text:"导出",icon:"el-icon-delete",cb:this.handleOutput}]},table:{dataList:[],handleSelectRow:this.handleSelectRow,selectedRow:{segmentId:0},isLoading:!1,expandAll:!1,thead:[{text:"细分ID",field:"segmentId",hidden:!0},{text:"细分名称",field:"segmentName",hidden:!1},{text:"状态",field:"activated",hidden:!1},{text:"细分类型",field:"static",hidden:!1},{text:"细分人数",field:"segmentResult",hidden:!1}]},pagination:{pageSizes:[10,25,50,100],pageSize:10,handleSizeChange:this.handleSizeChange,handleCurrentChange:this.handleCurrentChange,currentPage:1,total:0},tree:{leftTree:[],chooseItem:null}},output:{functions:{checkList:["列名","描述"],handleExpandAll:this.handleExpandAll},table:{dataList:[{colName:"member_code",colZHName:"会员号"},{colName:"mobile",colZHName:"手机号"},{colName:"name",colZHName:"姓名"},{colName:"birthday",colZHName:"生日"},{colName:"mail",colZHName:"邮箱"}],handleSelectionChange:this.handleSelectionChange,selectedRow:null,isLoading:!1,expandAll:!1,thead:[{text:"列名",field:"colName",hidden:!1},{text:"描述",field:"colZHName",hidden:!1}],sel:!0}}}},watch:{"pc.functions.checkList":function(e){m.a.each(this.pc.table.thead,function(t){var n=!1;m.a.each(e,function(e){t.text===e&&(t.hidden=!1,n=!0)}),n||(t.hidden=!0)})},"output.functions.checkList":function(e){m.a.each(this.output.table.thead,function(t){var n=!1;m.a.each(e,function(e){t.text===e&&(t.hidden=!1,n=!0)}),n||(t.hidden=!0)})}},methods:{handleSearch:function(){this.loadData()},handleSizeChange:function(e){this.pc.search.form.limit=e,this.pc.search.form.offset=this.pc.search.form.limit*(this.pc.pagination.currentPage-1),this.loadData()},handleCurrentChange:function(e){this.pc.pagination.currentPage=e,this.pc.search.form.offset=this.pc.search.form.limit*(this.pc.pagination.currentPage-1),this.loadData()},handleSelectRow:function(e){this.pc.table.selectedRow=e,console.log(e)},handleSelectionChange:function(e){this.output.table.selectedRow=e},handleExpandAll:function(){this.pc.table.expandAll=!this.pc.table.expandAll},itemClick:function(e,t){this.pc.search.form.segmentTypeId=t.id,this.loadData(),this.pc.tree.chooseItem=t},handleAdd:function(){null===this.pc.tree.chooseItem?i.Message.error("请先选择客户细分类型"):void 0!==this.pc.tree.chooseItem.children?i.Message.error("此节点不能添加，请选择此节点的子节点"):this.$router.push("/segment/customer-edit/0")},handleEdit:function(){null===this.pc.table.selectedRow?i.Message.error("请先选中表格中的某一记录！"):this.$router.push({name:"customer-edit",params:{segmentId:this.pc.table.selectedRow.segmentId,segmentTypeId:this.pc.table.selectedRow.segmentTypeId}})},handleDelete:function(){var e=this;null===this.pc.table.selectedRow?i.Message.error("请先选中表格中的某一记录！"):this.$confirm("确定要删除吗?","信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return Object(c.b)({segmentId:e.pc.table.selectedRow.segmentId}).then(function(t){console.log(t),0===t.code&&(e.$message({type:"success",message:"删除成功!"}),e.loadData())})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},loadData:function(){var e=this;return this.pc.table.isLoading=!0,Object(c.d)(this.pc.search.form).then(function(t){var n=t;e.pc.table.dataList=Object(l.a)(n.rows),e.pc.pagination.total=n.total,e.pc.table.isLoading=!1}).catch(function(t){console.log(t),e.pc.table.isLoading=!1})},getOptions:function(){var e=this;return Object(c.e)().then(function(t){var n=t.data,a=n.ztree;e.pc.tree.leftTree=Object(l.b)(a),e.pc.search.formConfig[1].options=n.staticSelect,e.pc.search.formConfig[2].options=n.activatedSelect}).catch(function(e){console.log(e)})},getBtns:function(){var e=this;return Object(s.a)(36).then(function(t){var n=t.data,a=m.a.clone(e.pc.functions.rightBtns);m.a.each(n,function(e){m.a.find(a,function(t){return t.text===e.name})||a.push({text:e.name,icon:e.icon,cb:function(){}})}),a=m.a.filter(a,function(e){return m.a.find(n,function(t){return e.text===t.name})}),e.pc.functions.rightBtns=a})},handleOutput:function(){null===this.pc.table.selectedRow?i.Message.error("请先选中表格中的某一记录！"):(console.log(this.pc.table.selectedRow),f.a.open({type:1,title:"选择导出列",shadeClose:!0,shade:!1,maxmin:!0,area:["893px","600px"],content:e("#output")}))}},mounted:function(){o.a.all([this.loadData(),this.getOptions(),this.getBtns()])}}}).call(t,n("L7Pj"))},YvLT:function(e,t,n){"use strict";t.d=function(e){return Object(a.a)({url:"/segment/segment/query",method:"get",params:e})},t.e=function(e){return Object(a.a)({url:"/segment/segment/init",method:"get",params:e})},t.c=function(e){return Object(a.a)({url:"/segment/segment/detail",method:"get",params:e})},t.b=function(e){return Object(a.a)({url:"/segment/segment/delete",method:"post",data:e})},t.a=function(e){return Object(a.a)({url:"/member/member/save",method:"post",data:e})},t.f=function(e){return Object(a.a)({url:"/member/member/update",method:"post",data:e})};var a=n("vLgD")},hfpR:function(e,t,n){(e.exports=n("BkJT")(!1)).push([e.i,"\n.tree-box[data-v-19ec8c66] {\n  margin: 20px;\n}\n",""])},"n/6f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("TomH"),o={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"segment-container"},[n("div",{staticClass:"page-container"},[n("search-form",{attrs:{searchForm:e.pc.search}}),e._v(" "),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{xs:24,sm:6,md:6}},[n("div",{staticClass:"tree-box"},[n("v-jstree",{attrs:{data:e.pc.tree.leftTree,"whole-row":"","text-field-name":"name"},on:{"item-click":e.itemClick}})],1)]),e._v(" "),n("el-col",{attrs:{xs:24,sm:18,md:18}},[n("func-buttons",{attrs:{pcFun:e.pc.functions,pcTable:e.pc.table}}),e._v(" "),n("arvato-table",{attrs:{pcTable:e.pc.table,pagination:e.pc.pagination}}),e._v(" "),n("pagination",{attrs:{pagination:e.pc.pagination}})],1)],1)],1),e._v(" "),n("export-page",{attrs:{output:e.output,segmentId:e.pc.table.selectedRow.segmentId,id:"output"}})],1)},staticRenderFns:[]};var c=function(e){n("A9qC")},i=n("vSla")(a.a,o,!1,c,"data-v-19ec8c66",null);t.default=i.exports},ni1v:function(e,t,n){(e.exports=n("BkJT")(!1)).push([e.i,"\n.table.el-row[data-v-0059f7ff] {\n  margin: 15px 0;\n}\n",""])},r2Xd:function(e,t,n){var a=n("ni1v");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("8bSs")("4deac702",a,!0)},rnde:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("nV64"),o=n("uAC3"),c=n.n(o),i={name:"index",data:function(){return{colName:"",colZHName:"",token:c.a.get("Admin-Token")}},props:{output:{type:Object},segmentId:{type:Number}},components:{ArvatoTable:a.a},watch:{"output.table.selectedRow":function(e){console.log(e);var t="",n="";this.output.table.selectedRow.forEach(function(e){t+=e.colName+",",n+=e.colZHName+","}),this.colName=t.slice(0,t.length-1),this.colZHName=n.slice(0,n.length-1)}}},s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"export-container"},[n("el-button-group",[n("el-button",{attrs:{type:"primary",icon:"el-icon-tickets"},on:{click:e.output.functions.handleExpandAll}}),e._v(" "),n("el-dropdown",{attrs:{trigger:"click"}},[n("el-button",{attrs:{type:"primary"}},[n("i",{staticClass:"el-icon-menu"}),e._v(" "),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-checkbox-group",{model:{value:e.output.functions.checkList,callback:function(t){e.$set(e.output.functions,"checkList",t)},expression:"output.functions.checkList"}},e._l(e.output.table.thead,function(e){return n("el-checkbox",{key:e.text,attrs:{label:e.text}})}))],1)],1)],1),e._v(" "),n("div",{staticClass:"text-center"},[n("el-button",[n("a",{attrs:{href:"http://120.132.27.130:8086/api/segment/segment/exportMemberData?segmentId="+e.segmentId+"&colName="+e.colName+"&colZHName="+e.colZHName+"&token="+this.token}},[e._v("\n        导出\n      ")])])],1)],1)},staticRenderFns:[]};var l=n("vSla")(i,s,!1,function(e){n("r2Xd")},"data-v-0059f7ff",null);t.default=l.exports}});