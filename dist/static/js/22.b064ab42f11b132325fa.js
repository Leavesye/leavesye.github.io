webpackJsonp([22],{"4DED":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("5VXh"),o=a("0j9R"),s=a("wS1x"),i=a.n(s),r=a("0xDb"),l=a("XUE3"),c={name:"customlabel-edit",components:{CommonForm:o.a,VJstree:i.a},data:function(){return{title:"",isLoading:!1,form:{batchTag:"",batchDesc:"",batchStatus:"1"},rules:{batchTag:[{required:!0,message:"标签名称不能为空",trigger:"blur"}],batchDesc:[{required:!0,message:"描述不能为空",trigger:"blur"}],batchStatus:[{required:!0,message:"打标群组不能为空",trigger:"blur"}]},layoutConfig:{xs:24,sm:12,md:12},formConfig:[{type:1,label:"标签名称",key:"batchTag"},{type:1,label:"描述",key:"batchDesc"},{type:3,label:"打标群组",key:"batchStatus",options:[],handleSelect:this.handleSelect}],segmentTree:[],mark:[],manual:!1,fileList:[{name:"food.jpeg",url:"https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100"}]}},methods:{handleSave:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var a=t.$route.params.id;"0"!==a?(t.form.id=a,Object(l.g)(t.form).then(function(e){t.$router.push("/segment/customlabel-list"),n.Message.success("修改成功")})):Object(l.a)(t.form).then(function(e){n.Message.success("保存成功"),t.$router.push("/segment/customlabel-list")})})},handleSelect:function(e){switch(e){case"1":this.manual=!0;break;case"2":this.manual=!1}},loadDetail:function(e){var t=this;this.isLoading=!0,Object(l.d)(e).then(function(e){var a=e;t.segmentTree=Object(r.b)(a.segmentTree),t.formConfig[2].options=a.batchTagTypeList,t.isLoading=!1}).catch(function(e){console.log(e),t.isLoading=!1}),Object(l.c)(e).then(function(e){})},itemClick:function(e,t){console.log(t),t.selected?(this.mark.push(t.name),this.selectChildren(t)):this.mark.splice(this.mark.indexOf(t.name),1)},selectChildren:function(e){var t=this;e.children&&e.children.forEach(function(e){e.selected=!0,t.selectChildren(e)}),console.log(e)},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择 3 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")}},mounted:function(){if("0"!==this.$route.params.id)return this.title="修改批量打标签",void this.loadDetail({batchTagId:this.$route.params.id});this.title="新增批量打标签",this.loadDetail("")}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],ref:"form",staticClass:"edit-container",attrs:{model:e.form,rules:e.rules,"label-width":"80px","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[a("div",{staticClass:"panel"},[a("h4",[e._v(e._s(e.title))]),e._v(" "),a("common-form",{attrs:{formConfig:e.formConfig,layoutConfig:e.layoutConfig,form:e.form}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.manual,expression:"!manual"}]},[a("el-input",{attrs:{clearable:""},model:{value:e.form.batchTagInfo,callback:function(t){e.$set(e.form,"batchTagInfo",t)},expression:"form.batchTagInfo"}}),e._v(" "),a("v-jstree",{attrs:{data:e.segmentTree,"whole-row":"","show-checkbox":"",multiple:"","allow-batch":"","text-field-name":"name"},on:{"item-click":e.itemClick}})],1),e._v(" "),a("el-upload",{directives:[{name:"show",rawName:"v-show",value:e.manual,expression:"manual"}],staticClass:"upload-demo",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"",limit:3,"on-exceed":e.handleExceed,"file-list":e.fileList}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1),e._v(" "),a("el-row",{staticClass:"text-center"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSave("form")}}},[e._v("确定")]),e._v(" "),a("router-link",{attrs:{to:"/segment/batchtag-list"}},[a("el-button",{attrs:{type:"primary"}},[e._v("取消")])],1)],1)],1)])},staticRenderFns:[]};var u=a("vSla")(c,m,!1,function(e){a("XLji")},"data-v-98147ba0",null);t.default=u.exports},"RKJ/":function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"",""])},XLji:function(e,t,a){var n=a("RKJ/");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("8bSs")("6661f2b3",n,!0)},XUE3:function(e,t,a){"use strict";t.e=function(e){return Object(n.a)({url:"/segment/batchTag/list.json",method:"get",params:e})},t.f=function(e){return Object(n.a)({url:"/segment/batchTag/init",method:"get",params:e})},t.d=function(e){return Object(n.a)({url:"/segment/batchTag/init",method:"post",data:e})},t.c=function(e){return Object(n.a)({url:"/segment/batchTag/getBatchTagUploadById",method:"get",params:e})},t.a=function(e){return Object(n.a)({url:"/member/member/save",method:"post",data:e})},t.g=function(e){return Object(n.a)({url:"/member/member/update",method:"post",data:e})},t.b=function(e){return Object(n.a)({url:"/segment/segment/delete",method:"post",data:e})};var n=a("vLgD")}});