webpackJsonp([13],{"/jSY":function(e,t,a){"use strict";t.c=function(e){return Object(n.a)({url:"/wechat/wechat/query",method:"get",params:e})},t.b=function(e){return Object(n.a)({url:"/wechat/wechat/detail",method:"get",params:e})},t.d=function(e){return Object(n.a)({url:"/wechat/wechat/save",method:"post",data:e})},t.a=function(e){return Object(n.a)({url:"/wechat/wechat/delete",method:"post",data:e})},t.e=function(e){return Object(n.a)({url:"/wechat/wechat/update",method:"post",data:e})};var n=a("vLgD")},"6XCE":function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"",""])},J6Fb:function(e,t,a){var n=a("6XCE");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("8bSs")("07ee2736",n,!0)},mmR7:function(e,t,a){"use strict";(function(e){var n=a("rVsN"),i=a.n(n),o=a("/jSY"),l=a("wS1x"),s=a.n(l),c=a("dizt"),d=a("0xDb"),r=a("W9rQ"),h=a("nFx2"),m=a("1fno"),p=a("Y0Uy"),u=a.n(p);t.a={name:"wechat-list",components:{ListPage:h.a,templateEdit:r.a,VJstree:s.a},data:function(){return{pc:{search:{form:{name:"",theme:"",sort:"id",order:"desc",offset:0,limit:10,menuId:40},layoutConfig:{xs:24,sm:12,md:6},formConfig:[{type:1,label:"模板名称",key:"name"},{type:1,label:"主题",key:"theme"}],btns:[{text:"搜索",cb:this.handleSearch}]},functions:{checkList:["模板名称","主题","创建人","创建时间"],handleExpandAll:this.handleExpandAll,rightBtns:[{text:"添加",icon:"el-icon-circle-plus",cb:this.handleAdd},{text:"编辑",icon:"el-icon-edit",cb:this.handleEdit},{text:"删除",icon:"el-icon-delete",cb:this.handleDelete}]},table:{dataList:[],handleSelectRow:this.handleSelectRow,selectedRow:null,isLoading:!1,expandAll:!1,thead:[{text:"ID",field:"templateId",hidden:!0},{text:"模板名称",field:"name",hidden:!1},{text:"主题",field:"theme",hidden:!1},{text:"创建人",field:"username",hidden:!1},{text:"创建时间",field:"createDateTime",hidden:!1}]},pagination:{pageSizes:[10,25,50,100],pageSize:10,handleSizeChange:this.handleSizeChange,handleCurrentChange:this.handleCurrentChange,currentPage:1,total:0}},template:{templateId:"",isLoading:!1,form:{name:"",theme:"",temId:"",sendContent:"",version:"",checked:!0},layoutConfig:{xs:24,sm:12,md:24},formConfig:[{type:1,label:"名称",key:"name"},{type:1,label:"主题",key:"theme"},{type:1,label:"模板ID",key:"temId"}],tagTree:[{id:0,name:"Same but with checkboxes",value:"Same but with checkboxes",icon:"",opened:!1,selected:!1,disabled:!1,loading:!1,children:[{id:1,name:"initially selected",value:"initially selected",icon:"",opened:!1,selected:!0,disabled:!1,loading:!1,children:[]}]}],layer:null,edit:!0}}},watch:{"pc.functions.checkList":function(e){u.a.each(this.pc.table.thead,function(t){var a=!1;u.a.each(e,function(e){t.text===e&&(t.hidden=!1,a=!0)}),a||(t.hidden=!0)})}},methods:{handleSearch:function(){this.loadData()},handleSizeChange:function(e){this.pc.search.form.limit=e,this.pc.search.form.offset=this.pc.search.form.limit*(this.pc.pagination.currentPage-1),this.loadData()},handleCurrentChange:function(e){this.pc.pagination.currentPage=e,this.pc.search.form.offset=this.pc.search.form.limit*(this.pc.pagination.currentPage-1),this.loadData()},handleSelectRow:function(e){this.pc.table.selectedRow=e,console.log(e)},handleExpandAll:function(){this.pc.table.expandAll=!this.pc.table.expandAll},handleAdd:function(){this.template.templateId="",this.loadTreeData(),this.template.layer=m.a.open({type:1,title:"添加短信模版",shadeClose:!0,shade:!1,maxmin:!0,area:["920px","600px"],content:e("#template-edit")})},handleEdit:function(){null===this.pc.table.selectedRow?this.$message({message:"请先选中表格中的某一记录",type:"error"}):(this.template.templateId=this.pc.table.selectedRow.templateId,this.loadTreeData(),this.template.layer=m.a.open({type:1,title:"编辑微信模版",shadeClose:!0,shade:!1,maxmin:!0,area:["800px","600px"],content:e("#template-edit")}))},handleDelete:function(){var e=this;this.$confirm("确定要删除吗?","信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.a)({templateId:e.pc.table.selectedRow.templateId}).then(function(t){0===t.code&&e.$message({type:"success",message:"删除成功!"}),e.loadData()})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},itemClick:function(e,t){t.children||(this.template.form.sendContent=void 0===this.template.form.sendContent?"":this.template.form.sendContent,this.template.form.sendContent+="{"+String(t.id).substring(3,5)+"|"+t.name+"}")},close:function(){m.a.close(this.template.layer)},save:function(e){var t=this;this.template.form.sendContentFormat="<p>"+this.template.form.sendContent+"</p>",""===e?Object(o.d)(this.template.form).then(function(e){t.$message({message:"保存成功",type:"success"}),t.loadData(),t.close()}):(this.template.form.id=e,Object(o.e)(this.template.form).then(function(e){t.$message({message:"保存成功",type:"success"}),t.loadData(),t.close()}))},loadData:function(){var e=this;return this.pc.table.isLoading=!0,Object(o.c)(this.pc.search.form).then(function(t){var a=t;console.log(a.rows),e.pc.table.dataList=Object(d.a)(a.rows),e.pc.pagination.total=a.total,e.pc.table.isLoading=!1}).catch(function(t){console.log(t),e.pc.table.isLoading=!1})},handleOutput:function(e,t){console.log(e,t)},loadTreeData:function(){var e=this;Object(o.b)({templateId:this.template.templateId}).then(function(t){e.template.tagTree=Object(d.b)(t.data.tagTree),e.template.form={name:t.data.name,theme:t.data.theme,temId:t.data.temId,sendContent:t.data.sendContent,version:t.data.version,checked:!1}}).catch(function(t){console.log(t),e.isLoading=!1})},getBtns:function(){var e=this;return Object(c.a)(40).then(function(t){var a=t.data,n=u.a.clone(e.pc.functions.rightBtns);u.a.each(a,function(e){u.a.find(n,function(t){return t.text===e.name})||n.push({text:e.name,icon:e.icon,cb:function(){}})}),n=u.a.filter(n,function(e){return u.a.find(a,function(t){return e.text===t.name})}),e.pc.functions.rightBtns=n})}},mounted:function(){i.a.all([this.loadData(),this.getBtns()])}}}).call(t,a("L7Pj"))},yDhS:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("mmR7"),i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"coupon-container"},[a("list-page",{attrs:{pc:e.pc}}),e._v(" "),a("template-edit",{attrs:{template:e.template},on:{save:e.save,close:e.close}},[a("template",{slot:"extraForm"},[a("el-col",{attrs:{xs:24,sm:24,md:24}},[a("el-form-item",{attrs:{label:"标签"}},[a("div",{staticClass:"templateInput"},[a("el-dropdown",{attrs:{trigger:"click","hide-on-click":!1}},[a("div",{staticClass:"input-header el-dropdown-link"},[a("el-button",{attrs:{icon:"el-icon-edit"}},[e._v("标签")])],1),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("v-jstree",{attrs:{data:e.template.tagTree,"whole-row":"","text-field-name":"name"},on:{"item-click":e.itemClick}})],1)],1)],1),e._v(" "),a("el-input",{attrs:{type:"textarea",autosize:"",rows:2,placeholder:"请输入"},model:{value:e.template.form.sendContent,callback:function(t){e.$set(e.template.form,"sendContent",t)},expression:"template.form.sendContent"}})],1)])],1),e._v(" "),a("el-col",{attrs:{xs:24,sm:24,md:24}},[a("el-checkbox",{staticClass:"text-right",model:{value:e.template.form.checked,callback:function(t){e.$set(e.template.form,"checked",t)},expression:"template.form.checked"}},[e._v("\n            是否验证标签\n          ")])],1)],1)],2)],1)},staticRenderFns:[]};var o=function(e){a("J6Fb")},l=a("vSla")(n.a,i,!1,o,"data-v-324022b0",null);t.default=l.exports}});