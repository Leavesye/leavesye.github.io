webpackJsonp([2],{"8VNF":function(t,e,n){(t.exports=n("BkJT")(!1)).push([t.i,"\n.box-card[data-v-accf288a] {\n  background: #666;\n  font-size: 14px;\n  font-weight: bold;\n  position: absolute;\n  right: 0;\n  top: 90px;\n  overflow: visible;\n  line-height: 1.5;\n}\n.box-card .icon[data-v-accf288a] {\n    color: green;\n    position: absolute;\n    left: -28px;\n    top: 1px;\n    z-index: 10;\n    background: #fff;\n    padding: 4px;\n    width: 30px;\n    height: 30px;\n    -webkit-box-shadow: -2px 1px 6px #ddd;\n    box-shadow: -1px 0px 4px #ddd;\n}\n.box-card .icon svg.svg-icon[data-v-accf288a] {\n      width: 24px;\n      height: 24px;\n      padding: 3px;\n      -webkit-animation: fa-spin 2s infinite linear;\n      animation: fa-spin 2s infinite linear;\n}\n",""])},"F/sw":function(t,e,n){var a=n("8VNF");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("791c6d7b",a,!0)},SGku:function(t,e,n){"use strict";(function(t){var a=n("tjM6"),i=n("dizt"),c=n("0xDb"),o=n("bwjF"),l=n("nFx2"),s=n("W9rQ"),r=n("1fno"),d=n("Y0Uy"),u=n.n(d);e.a={name:"wechat-list",components:{ListPage:l.a,templateEdit:s.a,WechatFloat:o.a},data:function(){return{pc:{search:{form:{sort:"id",order:"desc",offset:0,limit:10,publicaccountid:"",title:"",menuId:227},layoutConfig:{xs:24,sm:12,md:6},formConfig:[{type:1,label:"标题",key:"title"}],btns:[{text:"搜索",cb:this.handleSearch}]},functions:{checkList:["标题","一级行业","二级行业","状态"],handleExpandAll:this.handleExpandAll,rightBtns:[{text:"查看",icon:"el-icon-view",cb:this.handleView},{text:"同步",icon:"el-icon-refresh",cb:this.handleSyn}]},table:{dataList:[],handleSelectRow:this.handleSelectRow,selectedRow:null,isLoading:!1,expandAll:!1,thead:[{text:"模板ID",field:"template_id",hidden:!0},{text:"标题",field:"title",hidden:!1},{text:"一级行业",field:"primary_industry",hidden:!1},{text:"二级行业",field:"deputy_industry",hidden:!1},{text:"状态",field:"status",hidden:!1}]},pagination:{pageSizes:[10,25,50,100],pageSize:10,handleSizeChange:this.handleSizeChange,handleCurrentChange:this.handleCurrentChange,currentPage:1,total:0}},template:{isLoading:!1,form:{templateId:"",title:"",primaryIndustry:"",deputyIndustry:"",templateContent:"",example:""},layoutConfig:{xs:24,sm:12,md:24},formConfig:[{type:1,label:"模版ID",key:"templateId",disabled:!0},{type:1,label:"标题",key:"title",disabled:!0},{type:1,label:"一级行业",key:"primaryIndustry",disabled:!0},{type:1,label:"二级行业",key:"deputyIndustry",disabled:!0},{type:2,label:"详细内容",key:"templateContent",disabled:!0},{type:2,label:"内容示例",key:"example",disabled:!0}],layer:null}}},watch:{"pc.functions.checkList":function(t){u.a.each(this.pc.table.thead,function(e){var n=!1;u.a.each(t,function(t){e.text===t&&(e.hidden=!1,n=!0)}),n||(e.hidden=!0)})}},methods:{handleSearch:function(){this.loadData()},handleSizeChange:function(t){this.pc.search.form.limit=t,this.pc.search.form.offset=this.pc.search.form.limit*(this.pc.pagination.currentPage-1),this.loadData()},handleCurrentChange:function(t){this.pc.pagination.currentPage=t,this.pc.search.form.offset=this.pc.search.form.limit*(this.pc.pagination.currentPage-1),this.loadData()},handleSelectRow:function(t){this.pc.table.selectedRow=t,console.log(t)},handleExpandAll:function(){this.pc.table.expandAll=!this.pc.table.expandAll},handleSyn:function(){var t=this;this.$confirm("确定要同步吗?","信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(a.c)({publicaccountid:t.pc.search.form.publicaccountid}).then(function(e){0===e.code&&t.$message({type:"success",message:"同步成功!"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleView:function(){null===this.pc.table.selectedRow?this.$message({message:"请先选中表格中的某一记录",type:"error"}):(this.viewWxtemplate(),this.template.layer=r.a.open({type:1,title:"查看微信模版",shadeClose:!0,shade:!1,maxmin:!0,area:["800px","600px"],content:t("#template-edit")}))},handleCommand:function(t){this.pc.search.form.publicaccountid=t,this.loadData()},close:function(){r.a.close(this.template.layer)},loadData:function(){var t=this;return this.pc.table.isLoading=!0,this.pc.search.form.publicaccountid=JSON.parse(window.localStorage.getItem("curraccount")).originalId,Object(a.b)(this.pc.search.form).then(function(e){var n=e;t.pc.table.dataList=Object(c.a)(n.rows),t.pc.pagination.total=n.total,t.pc.table.isLoading=!1}).catch(function(e){console.log(e),t.pc.table.isLoading=!1})},viewWxtemplate:function(){var t=this;return Object(a.d)({id:this.pc.table.selectedRow.id}).then(function(e){var n=e.wxtemplate;t.template.form={templateId:n.templateId,title:n.title,primaryIndustry:n.primaryIndustry,deputyIndustry:n.deputyIndustry,templateContent:n.templateContent,example:n.example}}).catch(function(e){console.log(e),t.pc.table.isLoading=!1})},handleOutput:function(t,e){console.log(t,e)},getBtns:function(){var t=this;return Object(i.a)(227).then(function(e){var n=e.data,a=u.a.clone(t.pc.functions.rightBtns);u.a.each(n,function(t){u.a.find(a,function(e){return e.text===t.name})||a.push({text:t.name,icon:t.icon,cb:function(){}})}),a=u.a.filter(a,function(t){return u.a.find(n,function(e){return t.text===e.name})}),t.pc.functions.rightBtns=a})}},mounted:function(){this.getBtns()}}}).call(e,n("L7Pj"))},ZNyI:function(t,e,n){var a=n("eziU");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("c8d39f7c",a,!0)},bwjF:function(t,e,n){"use strict";var a=n("3cXf"),i=n.n(a),c=n("tjM6"),o={name:"wechat-float",data:function(){return{float:{hidden:!0,accountList:[],curraccount:{accountName:"",originalId:""}}}},beforeMount:function(){this.getAccountList()},methods:{getAccountList:function(){var t=this;void 0===window.localStorage.getItem("accountList")||null===window.localStorage.getItem("accountList")?Object(c.a)().then(function(e){t.float.accountList=e,t.float.curraccount=e[0],window.localStorage.setItem("curraccount",i()(e[0])),window.localStorage.setItem("accountList",i()(e)),t.$emit("handleCommand",e[0].originalId)}).catch(function(t){console.log(t)}):(this.float.accountList=JSON.parse(window.localStorage.getItem("accountList")),this.float.curraccount=JSON.parse(window.localStorage.getItem("curraccount")),this.$emit("handleCommand",this.float.curraccount.originalId))},handleCommand:function(t){var e=this;this.$confirm("确定要切换当前公众号至："+t.accountName+"?","信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.float.curraccount=t,window.localStorage.setItem("curraccount",i()(t)),e.$emit("handleCommand",t.originalId)}).catch(function(){e.$message({type:"info",message:"已取消切换"})})}}},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box-card"},[n("div",{staticClass:"icon",on:{click:function(e){t.float.hidden=!t.float.hidden}}},[n("svg-icon",{attrs:{"icon-class":"fa fa-weixin"}})],1),t._v(" "),t.float.hidden?n("el-card",[n("p",{staticClass:"title"},[t._v("当前公众号: "+t._s(t.float.curraccount.accountName))]),t._v(" "),n("el-dropdown",{on:{command:t.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[t._v("\n          切换公众号:"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.float.accountList,function(e,a){return n("el-dropdown-item",{key:a,attrs:{command:e}},[t._v(t._s(e.accountName))])}))],1)],1):t._e()],1)},staticRenderFns:[]};var s=n("vSla")(o,l,!1,function(t){n("F/sw")},"data-v-accf288a",null);e.a=s.exports},eziU:function(t,e,n){(t.exports=n("BkJT")(!1)).push([t.i,"",""])},tI0o:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("SGku"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"coupon-container"},[e("list-page",{attrs:{pc:this.pc}}),this._v(" "),e("template-edit",{attrs:{template:this.template},on:{close:this.close}}),this._v(" "),e("wechat-float",{on:{handleCommand:this.handleCommand}})],1)},staticRenderFns:[]};var c=function(t){n("ZNyI")},o=n("vSla")(a.a,i,!1,c,"data-v-7fc297a2",null);e.default=o.exports},tjM6:function(t,e,n){"use strict";e.b=function(t){return Object(a.a)({url:"/wmt/wechatTemplate/list",method:"get",params:t})},e.c=function(t){return Object(a.a)({url:"/wmt/wechatTemplate/wxtemplateSync",method:"get",params:t})},e.d=function(t){return Object(a.a)({url:"/wmt/wechatTemplate/viewWxtemplate",method:"post",data:t})},e.a=function(){return Object(a.a)({url:"/wmt/publicAccount/auth/accountList",method:"get"})};var a=n("vLgD")}});