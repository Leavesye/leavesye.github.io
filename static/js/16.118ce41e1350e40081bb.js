webpackJsonp([16],{"80AH":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("iklR"),n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("list-page",{attrs:{pc:e.pc}}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:1==e.dailogConfig.showType,expression:"dailogConfig.showType==1"}],attrs:{id:"task-edit"}},[o("el-form",{ref:"dailogConfig.form",staticClass:"edit-form",attrs:{"label-position":"right","label-width":e.dailogConfig.formLabelWidth,model:e.dailogConfig.form,rules:e.dailogConfig.rules}},[o("common-form",{attrs:{formConfig:e.dailogConfig.formConfig,layoutConfig:e.dailogConfig.layoutConfig,form:e.dailogConfig.form}}),e._v(" "),o("el-row",{staticStyle:{"text-align":"center"}},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSave("dailogConfig.form")}}},[e._v("确定")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.handleCloseEdit}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var i=function(e){o("JxW1")},r=o("vSla")(a.a,n,!1,i,"data-v-5e707038",null);t.default=r.exports},JxW1:function(e,t,o){var a=o("SfFD");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o("8bSs")("19b75396",a,!0)},SfFD:function(e,t,o){(e.exports=o("BkJT")(!1)).push([e.i,"\n.edit-form[data-v-5e707038] {\n  margin: 20px;\n}\n.el-checkbox[data-v-5e707038] {\n  display: inline;\n  margin: 3px;\n}\n.el-checkbox .el-checkbox__label[data-v-5e707038] {\n    padding-left: 5px;\n}\n.el-radio + .el-radio[data-v-5e707038] {\n  margin-left: 10px;\n}\n#role-auth[data-v-5e707038] {\n  margin: 20px;\n}\n",""])},iklR:function(e,t,o){"use strict";(function(e){var a=o("rVsN"),n=o.n(a),i=o("3cXf"),r=o.n(i),l=o("lbnp"),s=o("dizt"),c=o("0xDb"),d=o("nFx2"),g=o("0j9R"),u=o("Y0Uy"),f=o.n(u),h=o("1fno");t.a={name:"task-list",components:{ListPage:d.a,CommonForm:g.a},data:function(){return{pc:{search:{form:{jobGroup:"",executorHandler:"",sort:"id",order:"desc",offset:0,limit:10,menuId:91},layoutConfig:{xs:24,sm:12,md:6},formConfig:[{type:3,label:"执行器",key:"jobGroup",options:[]},{type:1,label:"JobHandler",key:"executorHandler"}],btns:[{text:"搜索",cb:this.handleSearch}]},functions:{checkList:["JobKey","描述","运行模式","Cron","负责人","状态"],handleExpandAll:this.handleExpandAll,rightBtns:[{text:"添加",icon:"el-icon-circle-plus",cb:this.handleAdd},{text:"编辑",icon:"el-icon-edit",cb:this.handleEdit},{text:"删除",icon:"el-icon-delete",cb:this.handleDelete}]},table:{dataList:[],handleSelectRow:this.handleSelectRow,selectedRow:null,isLoading:!1,expandAll:!1,thead:[{text:"id",field:"id",hidden:!0},{text:"jobGroup",field:"jobGroup",hidden:!0},{text:"JobKey",field:"JobKey",hidden:!1},{text:"描述",field:"jobDesc",hidden:!1},{text:"运行模式",field:"glueTypeStr",hidden:!1},{text:"任务参数",field:"jobDesc",hidden:!0},{text:"Cron",field:"jobCron",hidden:!1},{text:"新增时间",field:"addTime",hidden:!0},{text:"更新时间",field:"updateTime",hidden:!0},{text:"负责人",field:"author",hidden:!1},{text:"报警邮件",field:"alarmEmail",hidden:!0},{text:"状态",field:"jobStatus",hidden:!1}],operation:"more"},pagination:{pageSizes:[10,25,50,100],pageSize:10,handleSizeChange:this.handleSizeChange,handleCurrentChange:this.handleCurrentChange,currentPage:1,total:0}},dailogConfig:{type:1,showType:0,editLayerIndex:0,form:{id:"",jobGroup:"",jobDesc:"",executorRouteStrategy:"",jobCron:"",glueType:"",executorHandler:"",startTime:"",endTime:"",executorParam:"",childJobKey:"",executorBlockStrategy:"",executorFailStrategy:"",author:"",alarmEmail:""},formLabelWidth:"120px",layoutConfig:{xs:24,sm:24,md:12},formConfig:[{type:3,label:"执行器",key:"jobGroup",options:[]},{type:1,label:"任务描述",key:"jobDesc"},{type:3,label:"路由策略",key:"executorRouteStrategy",options:[]},{type:1,label:"Cron",key:"jobCron"},{type:3,label:"运行模式",key:"glueType",options:[]},{type:1,label:"JobHandler",key:"executorHandler"},{type:1,label:"开始时间",key:"startTime"},{type:1,label:"结束时间",key:"endTime"},{type:1,label:"执行参数",key:"executorParam"},{type:1,label:"子任务Key",key:"childJobKey"},{type:3,label:"阻塞处理策略",key:"executorBlockStrategy",options:[]},{type:3,label:"失败处理策略",key:"executorFailStrategy",options:[]},{type:1,label:"负责人",key:"author"},{type:1,label:"报警邮件:",key:"alarmEmail"}],rules:{jobGroup:[{required:!0,message:"请选择执行器",trigger:"change"}],jobDesc:[{required:!0,message:"任务描述不能为空",trigger:"blur"}],executorRouteStrategy:[{required:!0,message:"请选择路由策略",trigger:"change"}],jobCron:[{required:!0,message:"Cron不能为空",trigger:"blur"}],glueType:[{required:!0,message:"请选择运行模式",trigger:"change"}],executorHandler:[{required:!0,message:"JobHandler不能为空",trigger:"blur"}],executorBlockStrategy:[{required:!0,message:"请选择阻塞处理策略",trigger:"change"}],executorFailStrategy:[{required:!0,message:"请选择失败处理策略",trigger:"change"}],author:[{required:!0,message:"负责人不能为空",trigger:"blur"}]}}}},watch:{"pc.functions.checkList":function(e){f.a.each(this.pc.table.thead,function(t){var o=!1;f.a.each(e,function(e){t.text==e&&(t.hidden=!1,o=!0)}),o||(t.hidden=!0)})}},methods:{handleSearch:function(){this.loadData()},handleSizeChange:function(e){this.pc.search.form.limit=e,this.pc.search.form.offset=this.pc.search.form.limit*(this.pc.pagination.currentPage-1),this.loadData()},handleCurrentChange:function(e){this.pc.pagination.currentPage=e,this.pc.search.form.offset=this.pc.search.form.limit*(this.pc.pagination.currentPage-1),this.loadData()},handleSelectRow:function(e){this.pc.table.selectedRow=e,console.log(e)},handleExpandAll:function(){console.log("aaaaaa"),this.pc.table.expandAll=!this.pc.table.expandAll},handleAdd:function(){this.dailogConfig.type=1,this.dailogConfig.showType=1,this.dailogConfig.editLayerIndex=h.a.open({type:1,title:"新增任务",area:"600px",content:e("#task-edit")})},handleSave:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;if(1==t.dailogConfig.type){var o={};o.dasm=r()(t.dailogConfig.form),Object(l.a)(o,"/xxljob/jobinfo/save").then(function(e){0==e.code?(t.$message({type:"success",message:"添加成功"}),t.handleCloseEdit(),t.loadData(),t.resetEditForm()):t.$message({type:"error",message:e.msg})})}else{var a={};a.dasm=r()(t.dailogConfig.form),Object(l.a)(a,"/xxljob/jobinfo/save").then(function(e){0==e.code?(t.$message({type:"success",message:"修改成功"}),t.handleCloseEdit(),t.loadData(),t.resetEditForm()):t.$message({type:"error",message:e.msg})})}})},handleCloseEdit:function(){h.a.close(this.dailogConfig.editLayerIndex)},handleEdit:function(){if(!this.pc.table.selectedRow)return this.$message({type:"warning",message:"请先选中表格中的某一记录！"}),!1;var t=this.pc.table.selectedRow,o=this.dailogConfig.form;o.id=t.id,o.jobGroup=t.jobGroup,o.jobDesc=t.jobDesc,o.executorRouteStrategy=t.executorRouteStrategy,o.jobCron=t.jobCron,o.glueType=t.glueType,o.executorHandler=t.executorHandler,o.startTime=t.startTime,o.endTime=t.endTime,o.executorParam=t.executorParam,o.childJobKey=t.childJobKey,o.executorBlockStrategy=t.executorBlockStrategy,o.executorFailStrategy=t.executorFailStrategy,o.author=t.author,o.alarmEmail=t.alarmEmail,f.a.each(o,function(e,t){"-"==e&&(o[t]="")}),this.dailogConfig.type=2,this.dailogConfig.showType=1,this.dailogConfig.editLayerIndex=h.a.open({type:1,title:"编辑任务",area:"600px",content:e("#task-edit")})},handleDelete:function(){var e=this;this.$confirm("确定要删除吗?","信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message({type:"success",message:"删除成功!"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},loadData:function(){var e=this;return this.pc.table.isLoading=!0,Object(l.b)(this.pc.search.form,"/xxljob/jobinfo/query").then(function(t){console.log(t);var o=t;f.a.each(o.rows,function(e){console.log(e),e.glueTypeStr=e.glueType+"模式："+e.executorHandler,e.JobKey=e.jobGroup+"_"+e.id}),e.pc.table.dataList=Object(c.a)(o.rows),e.pc.pagination.total=o.total,e.pc.table.isLoading=!1}).catch(function(t){console.log(t),e.pc.table.isLoading=!1})},handleOutput:function(e,t){console.log(e,t)},getOptions:function(){var e=this;return Object(l.c)("","/xxljob/jobinfo/init").then(function(t){var o=t.data;console.log(o),e.pc.search.formConfig[0].options=o.jobgroupSelect,e.dailogConfig.formConfig[0].options=o.jobgroupSelect,e.dailogConfig.formConfig[2].options=o.ExecutorRouteStrategyEnum,e.dailogConfig.formConfig[4].options=o.GlueTypeEnum,e.dailogConfig.formConfig[10].options=o.ExecutorBlockStrategyEnum,e.dailogConfig.formConfig[11].options=o.ExecutorFailStrategyEnum}).catch(function(e){console.log(e)})},getBtns:function(){var e=this;return Object(s.a)(this.pc.search.form.menuId).then(function(t){var o=t.data,a=f.a.clone(e.pc.functions.rightBtns);f.a.each(o,function(e){f.a.find(a,function(t){return t.text===e.name})||a.push({text:e.name,icon:e.icon,cb:function(){}})}),a=f.a.filter(a,function(e){return f.a.find(o,function(t){return e.text==t.name})}),e.pc.functions.rightBtns=a})}},mounted:function(){n.a.all([this.loadData(),this.getOptions(),this.getBtns()])}}}).call(t,o("L7Pj"))},lbnp:function(e,t,o){"use strict";t.b=function(e,t){return Object(a.a)({url:t,method:"get",params:e})},t.c=function(e,t){return Object(a.a)({url:t,method:"get",params:e})},t.a=function(e,t){return Object(a.a)({url:t,method:"post",data:e})};var a=o("vLgD");o("TIfe")}});