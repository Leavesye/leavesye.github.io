webpackJsonp([26],{"5LJR":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("Y0Uy"),n=i.n(r),o=i("5VXh"),a=i("0j9R"),s=i("E4LH"),d=i("bLzv"),l={},m={name:"member-edit",components:{CommonForm:a.a},data:function(){return{isLoading:!1,form:{id:"",name:"",mobile:"",sex:"1",birthday:"",channel:1,status:"1",idType:"1",idNo:"",mail:"",addressMutiString:[],mediaAccountMutiString:[],kidMutiString:[]},rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"},{min:1,max:20,message:"长度需在 1 到 20 个字符",trigger:"blur"}],mobile:[{required:!0,message:"手机不能为空",trigger:"blur"},{validator:s.c,trigger:"blur"}],birthday:[{required:!0,message:"出生日期不能为空",trigger:"blur"}],idNo:[{validator:s.b,trigger:"blur"}],mail:[{validator:s.a,trigger:"blur"},{required:!0,message:"Email不能为空",trigger:"blur"}],address:[{required:!0,message:"详细地址不能为空",trigger:"blur"}],zipCode:[{required:!0,message:"邮政编码不能为空",trigger:"blur"}],mediaAccount:[{required:!0,message:"账号不能为空",trigger:"blur"}],kidname:[{required:!0,message:"姓名不能为空",trigger:"blur"}],kidsex:[{required:!0,message:"请选择性别",trigger:"change"}],kidbirthday:[{type:"date",required:!0,message:"出生日期不能为空",trigger:"blur"}]},layoutConfig:{xs:24,sm:12,md:12},formConfig:[{type:1,label:"姓名",key:"name"},{type:1,label:"手机",key:"mobile"},{type:3,label:"性别",key:"sex",options:[]},{type:4,label:"出生日期",key:"birthday"},{type:3,label:"入会渠道",key:"channel",options:[]},{type:3,label:"会员状态",key:"status",options:[]},{type:3,label:"证件类型",key:"idType",options:[]},{type:1,label:"证件号码",key:"idNo"},{type:1,label:"Email",key:"mail"}],addressFormConfig:[],mediaFormConfig:[],kidFormConfig:[]}},methods:{handleAddAddress:function(){this.form.addressMutiString.push(n.a.cloneDeep({addressType:"1",address:"",zipCode:"",isOftenUse:"1",addressStatus:"1"}));this.addressFormConfig.length;this.addressFormConfig.push([{type:3,label:"地址类型",key:"addressType",options:l.addressTypeSelect},{type:1,label:"详细地址",key:"address"},{type:3,label:"常用地址",key:"isOftenUse",options:l.yesOrNoSelect},{type:1,label:"邮政编码",key:"zipCode"},{type:3,label:"状态",key:"addressStatus",options:l.addressStatusSelect}]),console.log(this.addressFormConfig)},handleAddAccount:function(){this.mediaFormConfig.push([{type:3,label:"媒体类型",key:"mediaType",options:l.mediaTypeSelect},{type:1,label:"账号",key:"mediaAccount"},{type:1,label:"备注",key:"description"}]),this.form.mediaAccountMutiString.push({mediaType:"1",mediaAccount:"",description:""})},handleAddKid:function(){this.kidFormConfig.push([{type:1,label:"姓名",key:"kidname"},{type:3,label:"性别",key:"kidsex",options:l.genderSelect},{type:4,label:"出生日期",key:"kidbirthday"}]),this.form.kidMutiString.push({kidname:"",kidsex:"1",kidbirthday:""})},handleDeleteAddress:function(e){this.addressFormConfig=n.a.filter(this.addressFormConfig,function(t,i){return i!=e}),this.form.addressMutiString=n.a.filter(this.form.addressMutiString,function(t,i){return i!=e})},handleDeleteAccount:function(e){this.mediaFormConfig=n.a.filter(this.mediaFormConfig,function(t,i){return i!=e}),this.form.mediaAccountMutiString=n.a.filter(this.form.mediaAccountMutiString,function(t,i){return i!=e})},handleDeleteKid:function(e){this.kidFormConfig=n.a.filter(this.kidFormConfig,function(t,i){return i!=e}),this.form.kidMutiString=n.a.filter(this.form.kidMutiString,function(t,i){return i!=e})},handleSave:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var i=t.$route.params.id;"0"!==i?(t.form.id=i,Object(d.f)(t.form).then(function(e){t.$router.push("/member/member-list"),o.Message.success("修改成功")})):Object(d.a)(t.form).then(function(e){o.Message.success("保存成功"),t.$router.push("/member/member-list")})})},handleCancel:function(){this.$router.push("/member/member-list")},loadDetail:function(e){var t=this;this.isLoading=!0,Object(d.c)(e).then(function(e){var i=e.data;l=i,t.formConfig[2].options=i.genderSelect,t.formConfig[4].options=i.channelSelect,t.formConfig[5].options=i.statusSelect,t.formConfig[6].options=i.idTypeSelect,n.a.each(t.addressFormConfig,function(e,t){0==t&&(e.options=i.addressTypeSelect),2==t&&(e.options=i.yesOrNoSelect),4==t&&(e.options=i.addressStatusSelect)}),n.a.each(t.mediaFormConfig,function(e,t){0==t&&(e.options=i.mediaTypeSelect)}),n.a.each(t.kidFormConfig,function(e,t){1==t&&(e.options=i.genderSelect)});var r=i.memberInfo;t.form.name=r.name,t.form.mobile=r.mobile,t.form.sex=r.sex,t.form.mobile=r.mobile,t.form.channel=Number(r.channel),t.form.status=r.status,t.form.idType=r.idType,t.form.idNo=r.idNo,t.form.mail=r.mail,t.isLoading=!1}).catch(function(e){t.isLoading=!1})}},mounted:function(){"0"===this.$route.params.id?this.loadDetail(null):this.loadDetail({memberId:this.$route.params.id})}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],ref:"form",staticClass:"edit-container",attrs:{model:e.form,rules:e.rules,"label-width":"80px","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[i("common-form",{attrs:{gutter:20,formConfig:e.formConfig,layoutConfig:e.layoutConfig,form:e.form}}),e._v(" "),i("el-row",{staticClass:"detail-item",attrs:{type:"flex",justify:"space-between"}},[i("div",[e._v("地址信息")]),e._v(" "),i("div",[i("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.handleAddAddress}},[e._v("添加")])],1)]),e._v(" "),e._l(e.addressFormConfig,function(t,r){return i("common-form",{key:r+"address",attrs:{gutter:20,formConfig:e.addressFormConfig[r],layoutConfig:e.layoutConfig,form:e.form.addressMutiString[r]}},[i("template",{slot:"delete-btn"},[i("el-col",{staticClass:"delete-btn",attrs:{xs:24,sm:12,md:12}},[i("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){e.handleDeleteAddress(r)}}})],1)],1)],2)}),e._v(" "),i("el-row",{staticClass:"detail-item",attrs:{type:"flex",justify:"space-between"}},[i("div",[e._v("社交媒体账号信息")]),e._v(" "),i("div",[i("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.handleAddAccount}},[e._v("添加")])],1)]),e._v(" "),e._l(e.mediaFormConfig,function(t,r){return i("common-form",{key:r+"media",attrs:{gutter:20,formConfig:t,layoutConfig:e.layoutConfig,form:e.form.mediaAccountMutiString[r]}},[i("template",{slot:"delete-btn"},[i("el-col",{staticClass:"delete-btn",attrs:{xs:24,sm:12,md:12}},[i("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){e.handleDeleteAccount(r)}}})],1)],1)],2)}),e._v(" "),i("el-row",{staticClass:"detail-item",attrs:{type:"flex",justify:"space-between"}},[i("div",[e._v("子女信息")]),e._v(" "),i("div",[i("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.handleAddKid}},[e._v("添加")])],1)]),e._v(" "),e._l(e.kidFormConfig,function(t,r){return i("common-form",{key:r+"kid",attrs:{gutter:20,formConfig:t,layoutConfig:e.layoutConfig,form:e.form.kidMutiString[r]}},[i("template",{slot:"delete-btn"},[i("el-col",{staticClass:"delete-btn",attrs:{xs:24,sm:12,md:12}},[i("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){e.handleDeleteKid(r)}}})],1)],1)],2)}),e._v(" "),i("el-row",{staticStyle:{"text-align":"center"}},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSave("form")}}},[e._v("确定")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleCancel}},[e._v("取消")])],1)],2)},staticRenderFns:[]};var u=i("vSla")(m,c,!1,function(e){i("6gid")},"data-v-67ddcc22",null);t.default=u.exports},"6gid":function(e,t,i){var r=i("eNL/");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);i("8bSs")("124812fe",r,!0)},bLzv:function(e,t,i){"use strict";t.d=function(e){return Object(r.a)({url:"/member/member/query",method:"get",params:e})},t.e=function(e){return Object(r.a)({url:"/member/member/init",method:"get",params:e})},t.c=function(e){return Object(r.a)({url:"/member/member/detail",method:"get",params:e})},t.a=function(e){return Object(r.a)({url:"/member/member/save",method:"post",data:e})},t.f=function(e){return Object(r.a)({url:"/member/member/update",method:"post",data:e})},t.b=function(e){return Object(r.a)({url:"/member/member/delete",method:"post",data:e})};var r=i("vLgD")},"eNL/":function(e,t,i){(e.exports=i("BkJT")(!1)).push([e.i,"\n.edit-container[data-v-67ddcc22] {\n  margin: 15px;\n  background: #fff;\n}\n.edit-container .detail-item[data-v-67ddcc22] {\n    padding: 0 20px;\n    height: 40px;\n    line-height: 40px;\n    margin-bottom: 10px;\n    background: #f1f4f6;\n}\n.edit-container .delete-btn[data-v-67ddcc22] {\n    text-align: right;\n}\n",""])}});